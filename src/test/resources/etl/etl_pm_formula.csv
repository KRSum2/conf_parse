ZTE|counter001|select etl_zte_r_b_cvocmocall.serverid,etl_zte_r_b_cvocmocall.btsid,etl_zte_r_b_cvocmocall.cellid,etl_zte_r_b_cvocmocall.carrierid,sum(etl_zte_r_b_cvocmocall.cmo_callsuccessnum+etl_zte_r_b_cvocmocall.cmo_extinterruptnum+etl_zte_r_b_cvocmocall.accprobe_callsuccessnum+etl_zte_r_b_cvocmocall.accprobe_extinterruptnum+etl_zte_r_b_cvocmocall.accho_callsuccessnum+etl_zte_r_b_cvocmocall.accho_extinterruptnum+etl_zte_r_b_cconvocmocall.callsuccessnum+etl_zte_r_b_cconvocmocall.extinterruptnum+etl_zte_r_b_cvocmtcall.cmo_callsuccessnum+etl_zte_r_b_cvocmtcall.cmo_extinterruptnum+etl_zte_r_b_cvocmtcall.accprobe_callsuccessnum+etl_zte_r_b_cvocmtcall.accprobe_extinterruptnum+etl_zte_r_b_cvocmtcall.accho_callsuccessnum+etl_zte_r_b_cvocmtcall.accho_extinterruptnum+etl_zte_r_b_cvocmtcall.assignsoft_callsuccessnum+etl_zte_r_b_cvocmtcall.assignsoft_extinterruptnum+etl_zte_r_b_csmsmo.assignsoft_extinterruptnum+etl_zte_r_b_csmsmt.assignsoft_callsuccessnum+etl_zte_r_b_csmsmt.assignsoft_extinterruptnum+etl_zte_r_b_cvocmocall.assignsoft_callsuccessnum+etl_zte_r_b_cvocmocall.assignsoft_extinterruptnum+etl_zte_r_b_cconvocmtcall.callsuccessnum+etl_zte_r_b_cconvocmtcall.extinterruptnum+etl_zte_r_b_csmsmo.cmo_callsuccessnum+etl_zte_r_b_csmsmo.cmo_extinterruptnum+etl_zte_r_b_csmsmo.accprobe_callsuccessnum+etl_zte_r_b_csmsmo.accprobe_extinterruptnum+etl_zte_r_b_csmsmo.accho_callsuccessnum+etl_zte_r_b_csmsmo.accho_extinterruptnum+etl_zte_r_b_csmsmo.assignsoft_callsuccessnum+etl_zte_r_b_csmsmt.cmo_callsuccessnum+etl_zte_r_b_csmsmt.cmo_extinterruptnum+etl_zte_r_b_csmsmt.accprobe_callsuccessnum+etl_zte_r_b_csmsmt.accprobe_extinterruptnum+etl_zte_r_b_csmsmt.accho_callsuccessnum+etl_zte_r_b_csmsmt.accho_extinterruptnum) value from etl_zte_r_b_cvocmocall etl_zte_r_b_cvocmocall left join etl_zte_r_b_cconvocmocall etl_zte_r_b_cconvocmocall on etl_zte_r_b_cvocmocall.serverid = etl_zte_r_b_cconvocmocall.serverid and etl_zte_r_b_cvocmocall.btsid = etl_zte_r_b_cconvocmocall.btsid and etl_zte_r_b_cvocmocall.cellid = etl_zte_r_b_cconvocmocall.cellid and etl_zte_r_b_cvocmocall.carrierid = etl_zte_r_b_cconvocmocall.carrierid and etl_zte_r_b_cvocmocall.starttime = etl_zte_r_b_cconvocmocall.starttime left join etl_zte_r_b_cvocmtcall etl_zte_r_b_cvocmtcall on etl_zte_r_b_cvocmocall.serverid = etl_zte_r_b_cvocmtcall.serverid and etl_zte_r_b_cvocmocall.btsid = etl_zte_r_b_cvocmtcall.btsid and etl_zte_r_b_cvocmocall.cellid = etl_zte_r_b_cvocmtcall.cellid and etl_zte_r_b_cvocmocall.carrierid = etl_zte_r_b_cvocmtcall.carrierid and etl_zte_r_b_cvocmocall.starttime = etl_zte_r_b_cvocmtcall.starttime left join etl_zte_r_b_csmsmo etl_zte_r_b_csmsmo on etl_zte_r_b_cvocmocall.serverid = etl_zte_r_b_csmsmo.serverid and etl_zte_r_b_cvocmocall.btsid = etl_zte_r_b_csmsmo.btsid and etl_zte_r_b_cvocmocall.cellid = etl_zte_r_b_csmsmo.cellid and etl_zte_r_b_cvocmocall.carrierid = etl_zte_r_b_csmsmo.carrierid and etl_zte_r_b_cvocmocall.starttime = etl_zte_r_b_csmsmo.starttime left join etl_zte_r_b_csmsmt etl_zte_r_b_csmsmt on etl_zte_r_b_cvocmocall.serverid = etl_zte_r_b_csmsmt.serverid and etl_zte_r_b_cvocmocall.btsid = etl_zte_r_b_csmsmt.btsid and etl_zte_r_b_cvocmocall.cellid = etl_zte_r_b_csmsmt.cellid and etl_zte_r_b_cvocmocall.carrierid = etl_zte_r_b_csmsmt.carrierid and etl_zte_r_b_cvocmocall.starttime = etl_zte_r_b_csmsmt.starttime left join etl_zte_r_b_cconvocmtcall etl_zte_r_b_cconvocmtcall on etl_zte_r_b_cvocmocall.serverid = etl_zte_r_b_cconvocmtcall.serverid and etl_zte_r_b_cvocmocall.btsid = etl_zte_r_b_cconvocmtcall.btsid and etl_zte_r_b_cvocmocall.cellid = etl_zte_r_b_cconvocmtcall.cellid and etl_zte_r_b_cvocmocall.carrierid = etl_zte_r_b_cconvocmtcall.carrierid and etl_zte_r_b_cvocmocall.starttime = etl_zte_r_b_cconvocmtcall.starttime where etl_zte_r_b_cvocmocall.timestart = '@DATE' and etl_zte_r_b_cconvocmocall.timestart = '@DATE' and etl_zte_r_b_cvocmtcall.timestart = '@DATE' and etl_zte_r_b_csmsmo.timestart = '@DATE' and etl_zte_r_b_csmsmt.timestart = '@DATE' and etl_zte_r_b_cconvocmtcall.timestart = '@DATE' group by etl_zte_r_b_cvocmocall.serverid,etl_zte_r_b_cvocmocall.btsid,etl_zte_r_b_cvocmocall.cellid,etl_zte_r_b_cvocmocall.carrierid
ZTE|counter002|select etl_zte_r_b_cvocmocall.serverid,etl_zte_r_b_cvocmocall.btsid,etl_zte_r_b_cvocmocall.cellid,etl_zte_r_b_cvocmocall.carrierid,sum(etl_zte_r_b_cvocmocall.cmo_callsuccessnum+etl_zte_r_b_cvocmocall.cmo_extinterruptnum+etl_zte_r_b_cvocmocall.cmo_blockfailurenum+etl_zte_r_b_cvocmocall.cmo_otherfailurenum+etl_zte_r_b_cvocmocall.accprobe_callsuccessnum+etl_zte_r_b_cvocmocall.accprobe_extinterruptnum+etl_zte_r_b_cvocmocall.accprobe_blockfailurenum+etl_zte_r_b_cvocmocall.accprobe_otherfailurenum+etl_zte_r_b_cvocmocall.accho_callsuccessnum+etl_zte_r_b_cvocmocall.accho_extinterruptnum+etl_zte_r_b_cvocmocall.accho_blockfailurenum+etl_zte_r_b_cvocmocall.accho_otherfailurenum+etl_zte_r_b_cvocmocall.assignsoft_callsuccessnum+etl_zte_r_b_cvocmocall.assignsoft_extinterruptnum+etl_zte_r_b_cvocmocall.assignsoft_blockfailurenum+etl_zte_r_b_cvocmocall.assignsoft_otherfailurenum+etl_zte_r_b_cconvocmocall.callsuccessnum+etl_zte_r_b_cconvocmocall.extinterruptnum+etl_zte_r_b_cconvocmocall.blockfailurenum+etl_zte_r_b_cconvocmocall.otherfailurenum+etl_zte_r_b_cvocmtcall.cmo_callsuccessnum+etl_zte_r_b_cvocmtcall.cmo_extinterruptnum+etl_zte_r_b_cvocmtcall.cmo_blockfailurenum+etl_zte_r_b_cvocmtcall.cmo_otherfailurenum+etl_zte_r_b_cvocmtcall.accprobe_callsuccessnum+etl_zte_r_b_cvocmtcall.accprobe_extinterruptnum+etl_zte_r_b_cvocmtcall.accprobe_blockfailurenum+etl_zte_r_b_cvocmtcall.accprobe_otherfailurenum+etl_zte_r_b_cvocmtcall.accho_callsuccessnum+etl_zte_r_b_cvocmtcall.accho_extinterruptnum+etl_zte_r_b_cvocmtcall.accho_blockfailurenum+etl_zte_r_b_cvocmtcall.accho_otherfailurenum+etl_zte_r_b_cvocmtcall.assignsoft_callsuccessnum+etl_zte_r_b_cvocmtcall.assignsoft_extinterruptnum+etl_zte_r_b_cvocmtcall.assignsoft_blockfailurenum+etl_zte_r_b_cvocmtcall.assignsoft_otherfailurenum+etl_zte_r_b_cconvocmtcall.callsuccessnum+etl_zte_r_b_cconvocmtcall.extinterruptnum+etl_zte_r_b_cconvocmtcall.blockfailurenum+etl_zte_r_b_cconvocmtcall.otherfailurenum+etl_zte_r_b_csmsmo.cmo_callsuccessnum+etl_zte_r_b_csmsmo.cmo_extinterruptnum+etl_zte_r_b_csmsmo.cmo_blockfailurenum+etl_zte_r_b_csmsmo.cmo_otherfailurenum+etl_zte_r_b_csmsmo.accprobe_callsuccessnum+etl_zte_r_b_csmsmo.accprobe_extinterruptnum+etl_zte_r_b_csmsmo.accprobe_blockfailurenum+etl_zte_r_b_csmsmo.accprobe_otherfailurenum+etl_zte_r_b_csmsmo.accho_callsuccessnum+etl_zte_r_b_csmsmo.accho_extinterruptnum+etl_zte_r_b_csmsmo.accho_blockfailurenum+etl_zte_r_b_csmsmo.accho_otherfailurenum+etl_zte_r_b_csmsmo.assignsoft_callsuccessnum+etl_zte_r_b_csmsmo.assignsoft_extinterruptnum+etl_zte_r_b_csmsmo.assignsoft_blockfailurenum+etl_zte_r_b_csmsmo.assignsoft_otherfailurenum+etl_zte_r_b_csmsmt.cmo_callsuccessnum+etl_zte_r_b_csmsmt.cmo_extinterruptnum+etl_zte_r_b_csmsmt.cmo_blockfailurenum+etl_zte_r_b_csmsmt.cmo_otherfailurenum+etl_zte_r_b_csmsmt.accprobe_callsuccessnum+etl_zte_r_b_csmsmt.accprobe_extinterruptnum+etl_zte_r_b_csmsmt.accprobe_blockfailurenum+etl_zte_r_b_csmsmt.accprobe_otherfailurenum+etl_zte_r_b_csmsmt.accho_callsuccessnum+etl_zte_r_b_csmsmt.accho_extinterruptnum+etl_zte_r_b_csmsmt.accho_blockfailurenum+etl_zte_r_b_csmsmt.accho_otherfailurenum+etl_zte_r_b_csmsmt.assignsoft_callsuccessnum+etl_zte_r_b_csmsmt.assignsoft_extinterruptnum+etl_zte_r_b_csmsmt.assignsoft_blockfailurenum) value from etl_zte_r_b_cvocmocall etl_zte_r_b_cvocmocall left join etl_zte_r_b_cconvocmocall etl_zte_r_b_cconvocmocall on etl_zte_r_b_cvocmocall.serverid = etl_zte_r_b_cconvocmocall.serverid and etl_zte_r_b_cvocmocall.btsid = etl_zte_r_b_cconvocmocall.btsid and etl_zte_r_b_cvocmocall.cellid = etl_zte_r_b_cconvocmocall.cellid and etl_zte_r_b_cvocmocall.carrierid = etl_zte_r_b_cconvocmocall.carrierid and etl_zte_r_b_cvocmocall.starttime = etl_zte_r_b_cconvocmocall.starttime left join etl_zte_r_b_cvocmtcall etl_zte_r_b_cvocmtcall on etl_zte_r_b_cvocmocall.serverid = etl_zte_r_b_cvocmtcall.serverid and etl_zte_r_b_cvocmocall.btsid = etl_zte_r_b_cvocmtcall.btsid and etl_zte_r_b_cvocmocall.cellid = etl_zte_r_b_cvocmtcall.cellid and etl_zte_r_b_cvocmocall.carrierid = etl_zte_r_b_cvocmtcall.carrierid and etl_zte_r_b_cvocmocall.starttime = etl_zte_r_b_cvocmtcall.starttime left join etl_zte_r_b_csmsmo etl_zte_r_b_csmsmo on etl_zte_r_b_cvocmocall.serverid = etl_zte_r_b_csmsmo.serverid and etl_zte_r_b_cvocmocall.btsid = etl_zte_r_b_csmsmo.btsid and etl_zte_r_b_cvocmocall.cellid = etl_zte_r_b_csmsmo.cellid and etl_zte_r_b_cvocmocall.carrierid = etl_zte_r_b_csmsmo.carrierid and etl_zte_r_b_cvocmocall.starttime = etl_zte_r_b_csmsmo.starttime left join etl_zte_r_b_csmsmt etl_zte_r_b_csmsmt on etl_zte_r_b_cvocmocall.serverid = etl_zte_r_b_csmsmt.serverid and etl_zte_r_b_cvocmocall.btsid = etl_zte_r_b_csmsmt.btsid and etl_zte_r_b_cvocmocall.cellid = etl_zte_r_b_csmsmt.cellid and etl_zte_r_b_cvocmocall.carrierid = etl_zte_r_b_csmsmt.carrierid and etl_zte_r_b_cvocmocall.starttime = etl_zte_r_b_csmsmt.starttime left join etl_zte_r_b_cconvocmtcall etl_zte_r_b_cconvocmtcall on etl_zte_r_b_cvocmocall.serverid = etl_zte_r_b_cconvocmtcall.serverid and etl_zte_r_b_cvocmocall.btsid = etl_zte_r_b_cconvocmtcall.btsid and etl_zte_r_b_cvocmocall.cellid = etl_zte_r_b_cconvocmtcall.cellid and etl_zte_r_b_cvocmocall.carrierid = etl_zte_r_b_cconvocmtcall.carrierid and etl_zte_r_b_cvocmocall.starttime = etl_zte_r_b_cconvocmtcall.starttime where etl_zte_r_b_cvocmocall.timestart = '@DATE' and etl_zte_r_b_cconvocmocall.timestart = '@DATE' and etl_zte_r_b_cvocmtcall.timestart = '@DATE' and etl_zte_r_b_csmsmo.timestart = '@DATE' and etl_zte_r_b_csmsmt.timestart = '@DATE' and etl_zte_r_b_cconvocmtcall.timestart = '@DATE' group by etl_zte_r_b_cvocmocall.serverid,etl_zte_r_b_cvocmocall.btsid,etl_zte_r_b_cvocmocall.cellid,etl_zte_r_b_cvocmocall.carrierid
ZTE|counter003|select etl_zte_r_b_cvocrls.serverid , etl_zte_r_b_cvocrls.btsid , etl_zte_r_b_cvocrls.cellid , etl_zte_r_b_cvocrls.carrierid,sum(etl_zte_r_b_cvocrls.cm_radiofnum) value from etl_zte_r_b_cvocrls etl_zte_r_b_cvocrls where etl_zte_r_b_cvocrls.timestart = '@DATE' group by etl_zte_r_b_cvocrls.serverid,etl_zte_r_b_cvocrls.btsid,etl_zte_r_b_cvocrls.cellid,etl_zte_r_b_cvocrls.carrierid
ZTE|counter004|select etl_zte_r_b_cvocrls.serverid,etl_zte_r_b_cvocrls.btsid,etl_zte_r_b_cvocrls.cellid,etl_zte_r_b_cvocrls.carrierid,sum((etl_zte_r_b_cvocmocall.cmo_callsuccessnum+etl_zte_r_b_cvocmocall.cmo_extinterruptnum+etl_zte_r_b_cvocmocall.accprobe_callsuccessnum+etl_zte_r_b_cvocmocall.accprobe_extinterruptnum+etl_zte_r_b_cvocmocall.accho_callsuccessnum+etl_zte_r_b_cvocmocall.accho_extinterruptnum+etl_zte_r_b_cvocmocall.assignsoft_callsuccessnum+etl_zte_r_b_cvocmocall.assignsoft_extinterruptnum+etl_zte_r_b_cconvocmocall.callsuccessnum+etl_zte_r_b_cconvocmocall.extinterruptnum)+(etl_zte_r_b_cvocmtcall.cmo_callsuccessnum+etl_zte_r_b_cvocmtcall.cmo_extinterruptnum+etl_zte_r_b_cvocmtcall.accprobe_callsuccessnum+etl_zte_r_b_cvocmtcall.accprobe_extinterruptnum+etl_zte_r_b_cvocmtcall.accho_callsuccessnum+etl_zte_r_b_cvocmtcall.accho_extinterruptnum+etl_zte_r_b_cvocmtcall.assignsoft_callsuccessnum+etl_zte_r_b_cvocmtcall.assignsoft_extinterruptnum+etl_zte_r_b_cconvocmtcall.callsuccessnum+etl_zte_r_b_cconvocmtcall.extinterruptnum)) value from etl_zte_r_b_cvocrls etl_zte_r_b_cvocrls left join etl_zte_r_b_cvocmocall etl_zte_r_b_cvocmocall on etl_zte_r_b_cvocrls.serverid = etl_zte_r_b_cvocmocall.serverid and etl_zte_r_b_cvocrls.btsid = etl_zte_r_b_cvocmocall.btsid and etl_zte_r_b_cvocrls.cellid = etl_zte_r_b_cvocmocall.cellid and etl_zte_r_b_cvocrls.carrierid = etl_zte_r_b_cvocmocall.carrierid and etl_zte_r_b_cvocrls.starttime = etl_zte_r_b_cvocmocall.starttime left join etl_zte_r_b_cconvocmocall etl_zte_r_b_cconvocmocall on etl_zte_r_b_cvocrls.serverid = etl_zte_r_b_cconvocmocall.serverid and etl_zte_r_b_cvocrls.btsid = etl_zte_r_b_cconvocmocall.btsid and etl_zte_r_b_cvocrls.cellid = etl_zte_r_b_cconvocmocall.cellid and etl_zte_r_b_cvocrls.carrierid = etl_zte_r_b_cconvocmocall.carrierid and etl_zte_r_b_cvocrls.starttime = etl_zte_r_b_cconvocmocall.starttime left join etl_zte_r_b_cvocmtcall etl_zte_r_b_cvocmtcall on etl_zte_r_b_cvocrls.serverid = etl_zte_r_b_cvocmtcall.serverid and etl_zte_r_b_cvocrls.btsid = etl_zte_r_b_cvocmtcall.btsid and etl_zte_r_b_cvocrls.cellid = etl_zte_r_b_cvocmtcall.cellid and etl_zte_r_b_cvocrls.carrierid = etl_zte_r_b_cvocmtcall.carrierid and etl_zte_r_b_cvocrls.starttime = etl_zte_r_b_cvocmtcall.starttime left join etl_zte_r_b_cconvocmtcall etl_zte_r_b_cconvocmtcall on etl_zte_r_b_cvocrls.serverid = etl_zte_r_b_cconvocmtcall.serverid and etl_zte_r_b_cvocrls.btsid = etl_zte_r_b_cconvocmtcall.btsid and etl_zte_r_b_cvocrls.cellid = etl_zte_r_b_cconvocmtcall.cellid and etl_zte_r_b_cvocrls.carrierid = etl_zte_r_b_cconvocmtcall.carrierid and etl_zte_r_b_cvocrls.starttime = etl_zte_r_b_cconvocmtcall.starttime where etl_zte_r_b_cvocrls.timestart = '@DATE' and etl_zte_r_b_cvocmocall.timestart = '@DATE' and etl_zte_r_b_cconvocmocall.timestart = '@DATE' and etl_zte_r_b_cvocmtcall.timestart = '@DATE' and etl_zte_r_b_cconvocmtcall.timestart = '@DATE' group by etl_zte_r_b_cvocrls.serverid,etl_zte_r_b_cvocrls.btsid,etl_zte_r_b_cvocrls.cellid,etl_zte_r_b_cvocrls.carrierid
ZTE|counter005|select etl_zte_r_b_rfs.serverid,etl_zte_r_b_rfs.systemid,etl_zte_r_b_rfs.cellid,etl_zte_r_b_rfs.carrierid,avg(etl_zte_r_b_rfs.avgrssiinstant_d*1.0) value from etl_zte_r_b_rfs etl_zte_r_b_rfs where etl_zte_r_b_rfs.timestart = '@DATE' group by etl_zte_r_b_rfs.serverid,etl_zte_r_b_rfs.systemid,etl_zte_r_b_rfs.cellid,etl_zte_r_b_rfs.carrierid
ZTE|counter006|select etl_zte_r_b_rfs.serverid,etl_zte_r_b_rfs.systemid,etl_zte_r_b_rfs.cellid,etl_zte_r_b_rfs.carrierid,avg(etl_zte_r_b_rfs.avgrssiinstant_m*1.0) value from etl_zte_r_b_rfs etl_zte_r_b_rfs where etl_zte_r_b_rfs.timestart = '@DATE' group by etl_zte_r_b_rfs.serverid,etl_zte_r_b_rfs.systemid,etl_zte_r_b_rfs.cellid,etl_zte_r_b_rfs.carrierid
ZTE|counter007|select etl_zte_r_b_cdspmvocerl.serverid,etl_zte_r_b_cdspmvocerl.btsid,etl_zte_r_b_cdspmvocerl.cellid,etl_zte_r_b_cdspmvocerl.carrierid,sum(etl_zte_r_b_cbssapvocerl.avfassreq_avfsvcass_calldur+etl_zte_r_b_cdspmvocerl.avfsvcass_avfasscmp_calldur+etl_zte_r_b_cdspmvocerl.avrasscmp_avfrlsreq_calldur+etl_zte_r_b_cdspmvocerl.avfrlsreq_kilprc_calldur+etl_zte_r_b_cbssapsmserl.avfassreq_avfsvcass_calldur+etl_zte_r_b_cdspmsmserl.avfsvcass_avfasscmp_calldur+etl_zte_r_b_cdspmsmserl.avrasscmp_avfrlsreq_calldur+etl_zte_r_b_cdspmsmserl.avfrlsreq_kilprc_calldur+etl_zte_r_b_cconerl.avfsvcass_avfasscmp_calldur+etl_zte_r_b_cconerl.avrasscmp_avfrlsreq_calldur+etl_zte_r_b_cconerl.avfrlsreq_kilprc_calldur)/3600 from etl_zte_r_b_cdspmvocerl etl_zte_r_b_cdspmvocerl left join etl_zte_r_b_cdspmsmserl etl_zte_r_b_cdspmsmserl on etl_zte_r_b_cdspmvocerl.serverid = etl_zte_r_b_cdspmsmserl.serverid and etl_zte_r_b_cdspmvocerl.btsid = etl_zte_r_b_cdspmsmserl.btsid and etl_zte_r_b_cdspmvocerl.cellid = etl_zte_r_b_cdspmsmserl.cellid and etl_zte_r_b_cdspmvocerl.carrierid = etl_zte_r_b_cdspmsmserl.carrierid left join etl_zte_r_b_cconerl etl_zte_r_b_cconerl on etl_zte_r_b_cdspmvocerl.serverid = etl_zte_r_b_cconerl.serverid and etl_zte_r_b_cdspmvocerl.btsid = etl_zte_r_b_cconerl.btsid and etl_zte_r_b_cdspmvocerl.cellid = etl_zte_r_b_cconerl.cellid and etl_zte_r_b_cdspmvocerl.carrierid = etl_zte_r_b_cconerl.carrierid and etl_zte_r_b_cdspmvocerl.starttime = etl_zte_r_b_cconerl.starttime left join etl_zte_r_b_cbssapvocerl etl_zte_r_b_cbssapvocerl on etl_zte_r_b_cdspmvocerl.serverid = etl_zte_r_b_cbssapvocerl.serverid and etl_zte_r_b_cdspmvocerl.btsid = etl_zte_r_b_cbssapvocerl.btsid and etl_zte_r_b_cdspmvocerl.cellid = etl_zte_r_b_cbssapvocerl.cellid and etl_zte_r_b_cdspmvocerl.carrierid = etl_zte_r_b_cbssapvocerl.carrierid and etl_zte_r_b_cdspmvocerl.starttime = etl_zte_r_b_cbssapvocerl.starttime left join etl_zte_r_b_cbssapsmserl etl_zte_r_b_cbssapsmserl on etl_zte_r_b_cdspmvocerl.serverid = etl_zte_r_b_cbssapsmserl.serverid and etl_zte_r_b_cdspmvocerl.btsid = etl_zte_r_b_cbssapsmserl.btsid and etl_zte_r_b_cdspmvocerl.cellid = etl_zte_r_b_cbssapsmserl.cellid and etl_zte_r_b_cdspmvocerl.carrierid = etl_zte_r_b_cbssapsmserl.carrierid and etl_zte_r_b_cdspmvocerl.starttime = etl_zte_r_b_cbssapsmserl.starttime where etl_zte_r_b_cdspmvocerl.timestart = '@DATE'  and etl_zte_r_b_cdspmsmserl.timestart = '@DATE' and etl_zte_r_b_cconerl.timestart = '@DATE' and etl_zte_r_b_cbssapvocerl.timestart = '@DATE' and etl_zte_r_b_cbssapsmserl.timestart = '@DATE' group by etl_zte_r_b_cdspmvocerl.serverid,etl_zte_r_b_cdspmvocerl.btsid,etl_zte_r_b_cdspmvocerl.cellid,etl_zte_r_b_cdspmvocerl.carrierid
ZTE|counter008|SELECT R_B_CVocTgtBssHoErl.ServerId,R_B_CVocTgtBssHoErl.BtsId,R_B_CVocTgtBssHoErl.CellId,R_B_CVocTgtBssHoErl.CarrierId,SUM((R_B_CBssApVocErl.AvfAssReq_AvfSvcAss_CallDur+R_B_CDspmVocErl.AvfSvcAss_AvfAssCmp_CallDur+R_B_CDspmVocErl.AvrAssCmp_AvfRlsReq_CallDur+R_B_CDspmVocErl.AvfRlsReq_KilPrc_CallDur+R_B_CDspmVocErl.AvfSvcAss_AvfAssCmp_SHoDur+R_B_CDspmVocErl.AvrAssCmp_AvfRlsReq_ShoDur+R_B_CDspmVocErl.AvfRlsReq_KilPrc_ShoDur+R_B_CBssApSmsErl.AvfAssReq_AvfSvcAss_CallDur+R_B_CDspmSmsErl.AvfSvcAss_AvfAssCmp_CallDur+R_B_CDspmSmsErl.AvrAssCmp_AvfRlsReq_CallDur+R_B_CDspmSmsErl.AvfRlsReq_KilPrc_CallDur+R_B_CDspmSmsErl.AvfSvcAss_AvfAssCmp_SHoDur+R_B_CDspmSmsErl.AvrAssCmp_AvfRlsReq_ShoDur+R_B_CDspmSmsErl.AvfRlsReq_KilPrc_ShoDur+R_B_CConErl.AvfSvcAss_AvfAssCmp_CallDur+R_B_CConErl.AvrAssCmp_AvfRlsReq_CallDur+R_B_CConErl.AvfRlsReq_KilPrc_CallDur+R_B_CConErl.AvfSvcAss_AvfAssCmp_SHoDur+R_B_CConErl.AvrAssCmp_AvfRlsReq_ShoDur+R_B_CConErl.AvfRlsReq_KilPrc_ShoDur+R_B_CVocTgtBssHoErl.SHoDuration)/3600) FROM ETL_ZTE_R_B_CVocTgtBssHoErl R_B_CVocTgtBssHoErl LEFT JOIN ETL_ZTE_R_B_CDspmVocErl R_B_CDspmVocErl ON R_B_CVocTgtBssHoErl.starttime = R_B_CDspmVocErl.starttime AND R_B_CVocTgtBssHoErl.ServerId = R_B_CDspmVocErl.ServerId AND R_B_CVocTgtBssHoErl.BssId =R_B_CDspmVocErl.BssId AND R_B_CVocTgtBssHoErl.BtsId =R_B_CDspmVocErl.BtsId AND R_B_CVocTgtBssHoErl.CellId =R_B_CDspmVocErl.CellId AND R_B_CVocTgtBssHoErl.CarrierId =R_B_CDspmVocErl.CarrierId LEFT JOIN ETL_ZTE_R_B_CDspmSmsErl R_B_CDspmSmsErl ON R_B_CVocTgtBssHoErl.starttime = R_B_CDspmSmsErl.starttime AND R_B_CVocTgtBssHoErl.ServerId = R_B_CDspmSmsErl.ServerId AND R_B_CVocTgtBssHoErl.BssId =R_B_CDspmSmsErl.BssId AND R_B_CVocTgtBssHoErl.BtsId =R_B_CDspmSmsErl.BtsId AND R_B_CVocTgtBssHoErl.CellId =R_B_CDspmSmsErl.CellId AND R_B_CVocTgtBssHoErl.CarrierId =R_B_CDspmSmsErl.CarrierId LEFT JOIN ETL_ZTE_R_B_CConErl R_B_CConErl ON R_B_CVocTgtBssHoErl.starttime = R_B_CConErl.starttime AND R_B_CVocTgtBssHoErl.ServerId = R_B_CConErl.ServerId AND R_B_CVocTgtBssHoErl.BssId =R_B_CConErl.BssId AND R_B_CVocTgtBssHoErl.BtsId =R_B_CConErl.BtsId AND R_B_CVocTgtBssHoErl.CellId =R_B_CConErl.CellId AND R_B_CVocTgtBssHoErl.CarrierId =R_B_CConErl.CarrierId LEFT JOIN ETL_ZTE_R_B_CBssApVocErl R_B_CBssApVocErl ON R_B_CVocTgtBssHoErl.starttime = R_B_CBssApVocErl.starttime AND R_B_CVocTgtBssHoErl.ServerId = R_B_CBssApVocErl.ServerId AND R_B_CVocTgtBssHoErl.BssId =R_B_CBssApVocErl.BssId AND R_B_CVocTgtBssHoErl.BtsId =R_B_CBssApVocErl.BtsId AND R_B_CVocTgtBssHoErl.CellId =R_B_CBssApVocErl.CellId AND R_B_CVocTgtBssHoErl.CarrierId =R_B_CBssApVocErl.CarrierId LEFT JOIN ETL_ZTE_R_B_CBssApSmsErl R_B_CBssApSmsErl ON R_B_CVocTgtBssHoErl.starttime = R_B_CBssApSmsErl.starttime AND R_B_CVocTgtBssHoErl.ServerId = R_B_CBssApSmsErl.ServerId AND R_B_CVocTgtBssHoErl.BssId =R_B_CBssApSmsErl.BssId AND R_B_CVocTgtBssHoErl.BtsId =R_B_CBssApSmsErl.BtsId AND R_B_CVocTgtBssHoErl.CellId =R_B_CBssApSmsErl.CellId AND R_B_CVocTgtBssHoErl.CarrierId =R_B_CBssApSmsErl.CarrierId WHERE R_B_CVocTgtBssHoErl.timestart = '@DATE' group by R_B_CVocTgtBssHoErl.ServerId,R_B_CVocTgtBssHoErl.BtsId,R_B_CVocTgtBssHoErl.CellId,R_B_CVocTgtBssHoErl.CarrierId
HW|counter001|SELECT TB_1157628004.object_name , SUM(TB_1157628004.Counter_1157628270+TB_1157628019.Counter_1157632645+TB_1157628019.Counter_1157632646) VALUE FROM etl_hw_Result_1157628004 TB_1157628004 LEFT JOIN etl_hw_Result_1157628019 TB_1157628019 ON TB_1157628004.times = TB_1157628019.times AND TB_1157628004.object_name = TB_1157628019.object_name WHERE TB_1157628004.TIME = '@DATE' GROUP BY TB_1157628004.object_name
HW|counter002|SELECT TB_1157628004.object_name, SUM(TB_1157628004.Counter_1157628275+TB_1157628019.Counter_1157632642+TB_1157628019.Counter_1157632641) VALUE FROM etl_hw_Result_1157628004 TB_1157628004 LEFT JOIN etl_hw_Result_1157628019 TB_1157628019 ON TB_1157628004.times = TB_1157628019.times AND TB_1157628004.object_name= TB_1157628019.object_name WHERE TB_1157628004.TIME = '@DATE' GROUP BY TB_1157628004.object_name
HW|counter003|SELECT TB_1157628006.object_name , SUM(TB_1157628006.Counter_1157632969+TB_1157628006.Counter_1157632970+TB_1157628006.Counter_1157632971+TB_1157628006.Counter_1157632972+TB_1157628006.Counter_1157632973+TB_1157628006.Counter_1157632974) VALUE FROM etl_hw_Result_1157628006 TB_1157628006 WHERE TB_1157628006.time = '@DATE'  GROUP BY TB_1157628006.object_name
HW|counter004|SELECT TB_1157628004.object_name, SUM(TB_1157628004.Counter_1157628567+TB_1157628004.Counter_1157628587+TB_1157628004.Counter_1157628568+TB_1157628004.Counter_1157628588) VALUE FROM etl_hw_Result_1157628004 TB_1157628004 WHERE TB_1157628004.time = '@DATE' GROUP BY TB_1157628004.object_name
HW|counter005|SELECT TB_1166016533.object_name , ROUND(AVG(TB_1166016533.Counter_1166016875/10),2) FROM etl_hw_Result_1166016533 TB_1166016533 WHERE TB_1166016533.time =  '@DATE' GROUP BY TB_1166016533.object_name
HW|counter006|SELECT TB_1166016533.object_name , ROUND(AVG(TB_1166016533.Counter_1166016874/10),2) FROM etl_hw_Result_1166016533 TB_1166016533 WHERE TB_1166016533.time = '@DATE' GROUP BY TB_1166016533.object_name
HW|counter007|SELECT TB_1157629004.object_name, SUM(TB_1157629004.Counter_1157629305/3600) VALUE FROM etl_hw_Result_1157629004 TB_1157629004 WHERE TB_1157629004.time = '@DATE' GROUP BY TB_1157629004.object_name
HW|counter008|SELECT TB_1157629004.object_name, SUM(TB_1157629004.Counter_1157628066/3600) VALUE FROM etl_hw_Result_1157629004 TB_1157629004 WHERE TB_1157629004.time = '@DATE' GROUP BY TB_1157629004.object_name
AL|counter001|select pcarr.bts ,pcarr.sect ,pcarr.carr key,sum(pcarrsc.counter068 + pcarrsc.counter070 + pcarrsc.counter069 + pcarrsc.counter071 + pcarr.counter152 + pcarr.counter153) value from etl_al_cdma_paf_carr pcarr left join (select a.bts bts,a.sect sect,a.carr carr, sum(a.counter068) counter068,sum(a.counter070) counter070,sum(a.counter069) counter069,sum(a.counter071) counter071 from etl_al_cdma_paf_carr_sc a  where a.timestart = '@DATE' and (a.datatype='8K+SMV' or a.datatype='13K' or a.datatype='EVRC') group by a.bts,a.sect,a.carr) pcarrsc on pcarrsc.bts = pcarr.bts and pcarrsc.sect = pcarr.sect and pcarrsc.carr = pcarr.carr where pcarr.timestart = '@DATE' group by pcarr.bts ,pcarr.sect , pcarr.carr
AL|counter002|SELECT JN.BTS,JN.SECT,JN.CARR, SUM(JN.PCARRSC23V-JN.PCARRSC48V+JN.PCARRSC50V-JN.EPCARRSC28V-JN.PCARRSC118V-JN.EPCARRSC34V-JN.EPCARRSC43V-JN.PCARRSC159V-JN.PCARRSC160V-JN.PCARRSC194V-JN.PCARRSC196V+JN.PCARRSC24V-JN.PCARRSC51V+JN.PCARRSC53V-JN.EPCARRSC45V-JN.PCARRSC163V-JN.PCARRSC164V-JN.PCARRSC167V-JN.EPCARRSC30V+JN.PCARRSC36V-JN.PCARRSC54V+JN.PCARRSC56V-JN.EPCARRSC29V-JN.PCARRSC119V-JN.EPCARRSC35V-JN.EPCARRSC44V-JN.PCARRSC161V-JN.PCARRSC162V-JN.PCARRSC195V-JN.PCARRSC197V+JN.PCARRSC37V-JN.PCARRSC57V+JN.PCARRSC59V-JN.EPCARRSC46V-JN.PCARRSC165V-JN.PCARRSC166V-JN.PCARRSC168V-JN.EPCARRSC32V+PCARR.Counter062+PCARR.Counter063) VALUE FROM (SELECT PCARRSC.BTS,PCARRSC.SECT,PCARRSC.CARR,SUM(PCARRSC.Counter023) PCARRSC23V,SUM(PCARRSC.Counter048) PCARRSC48V,SUM(PCARRSC.Counter050) PCARRSC50V,SUM(EPCARRSC.Counter028) EPCARRSC28V,SUM(PCARRSC.Counter118) PCARRSC118V,SUM(EPCARRSC.Counter034) EPCARRSC34V,SUM(EPCARRSC.Counter043) EPCARRSC43V,SUM(PCARRSC.Counter159) PCARRSC159V,SUM(PCARRSC.Counter160) PCARRSC160V,SUM(PCARRSC.Counter194) PCARRSC194V,SUM(PCARRSC.Counter196) PCARRSC196V,SUM(PCARRSC.Counter024) PCARRSC24V,SUM(PCARRSC.Counter051) PCARRSC51V,SUM(PCARRSC.Counter053) PCARRSC53V,SUM(EPCARRSC.Counter045) EPCARRSC45V,SUM(PCARRSC.Counter163) PCARRSC163V,SUM(PCARRSC.Counter164) PCARRSC164V,SUM(PCARRSC.Counter167) PCARRSC167V,SUM(EPCARRSC.Counter030) EPCARRSC30V,SUM(PCARRSC.Counter036) PCARRSC36V,SUM(PCARRSC.Counter054) PCARRSC54V,SUM(PCARRSC.Counter056) PCARRSC56V,SUM(EPCARRSC.Counter029) EPCARRSC29V,SUM(PCARRSC.Counter119) PCARRSC119V,SUM(EPCARRSC.Counter035) EPCARRSC35V,SUM(EPCARRSC.Counter044) EPCARRSC44V,SUM(PCARRSC.Counter161) PCARRSC161V,SUM(PCARRSC.Counter162) PCARRSC162V,SUM(PCARRSC.Counter195) PCARRSC195V,SUM(PCARRSC.Counter197) PCARRSC197V,SUM(PCARRSC.Counter037) PCARRSC37V,SUM(PCARRSC.Counter057) PCARRSC57V,SUM(PCARRSC.Counter059) PCARRSC59V,SUM(EPCARRSC.Counter046) EPCARRSC46V,SUM(PCARRSC.Counter165) PCARRSC165V,SUM(PCARRSC.Counter166) PCARRSC166V,SUM(PCARRSC.Counter168) PCARRSC168V,SUM(EPCARRSC.Counter032) EPCARRSC32V FROM ETL_AL_CDMA_PAF_CARR_SC PCARRSC LEFT JOIN ETL_AL_ECP_PAF_CARR_SC_CDMA EPCARRSC ON PCARRSC.BTS = EPCARRSC.BTS AND PCARRSC.SECT = EPCARRSC.SECT AND PCARRSC.CARR = EPCARRSC.CARR AND PCARRSC.DATATYPE = EPCARRSC.DATATYPE WHERE PCARRSC.timestart = '@DATE' AND EPCARRSC.timestart = '@DATE' AND ( PCARRSC.DATATYPE = '8K+SMV' OR PCARRSC.DATATYPE = '13K' OR PCARRSC.DATATYPE = 'EVRC') AND ( EPCARRSC.DATATYPE = '8K+SMV' OR EPCARRSC.DATATYPE = '13K' OR EPCARRSC.DATATYPE = 'EVRC') GROUP BY PCARRSC.BTS,PCARRSC.SECT,PCARRSC.CARR) JN LEFT JOIN ETL_AL_CDMA_PAF_CARR PCARR ON JN.BTS = PCARR.BTS AND JN.SECT = PCARR.SECT AND JN.CARR = PCARR.CARR WHERE PCARR.timestart = '@DATE' GROUP BY JN.BTS,JN.SECT,JN.CARR
AL|counter003|SELECT BTS , SECT ,CARR ,SUM(COUNTER017+COUNTER018+COUNTER040+COUNTER041) VALUE FROM ETL_AL_CDMA_PAF_CARR_SC WHERE timestart = '@DATE' AND ( DATATYPE = '8K+SMV' OR DATATYPE = '13K' OR DATATYPE = 'EVRC') GROUP BY BTS , SECT ,CARR
AL|counter004|SELECT BTS, SECT, CARR ,SUM(COUNTER068+COUNTER070+COUNTER069+COUNTER071) VALUE FROM ETL_AL_CDMA_PAF_CARR_SC WHERE timestart = '@DATE' AND ( DATATYPE = '8K+SMV' OR DATATYPE = '13K' OR DATATYPE = 'EVRC') GROUP BY BTS , SECT , CARR
AL|counter005|SELECT BTS , SECT , CARR, AVG(PCARR.Counter074*1.0/100) VALUE FROM ETL_AL_CDMA_PAF_CARR PCARR WHERE PCARR.timestart = '@DATE' GROUP BY BTS , SECT , CARR
AL|counter007|SELECT BTS , SECT , CARR, SUM(PCARR.Counter006-PCARR.Counter008+PCARR.Counter276-PCARR.Counter277+PCARR.Counter278-PCARR.Counter279)/360 VALUE FROM ETL_AL_CDMA_PAF_CARR PCARR WHERE PCARR.timestart = '@DATE' GROUP BY BTS , SECT , CARR
AL|counter008|SELECT BTS , SECT , CARR, SUM(PCARR.Counter006+PCARR.Counter276+PCARR.Counter278)/360 VALUE FROM ETL_AL_CDMA_PAF_CARR PCARR WHERE PCARR.timestart = '@DATE' GROUP BY BTS , SECT , CARR
SECT|counter001|SELECT STARTTIME, HOUR, CITYID, BSC, BTS, SECT, SUM(COUNTER001) COUNTER001, SUM(COUNTER002) COUNTER002, SUM(COUNTER003) COUNTER003, SUM(COUNTER004) COUNTER004, SUM(COUNTER005) COUNTER005, SUM(COUNTER006) COUNTER006, SUM(COUNTER007) COUNTER007, SUM(COUNTER008) COUNTER008, SUM(COUNTER009) COUNTER009, SUM(COUNTER010) COUNTER010 FROM AGG_PM_CARR_HOUR WHERE TIMESTART = '@DATE' AND HOUR = @HOUR GROUP BY STARTTIME, HOUR, CITYID, BSC, BTS, SECT
BUSYCARR|counter001|SELECT * FROM (SELECT STARTTIME, HOUR,MANUFACTORYID, CITYID, BSC, BTS, SECT, CARR, COUNTER001, COUNTER002, COUNTER003, COUNTER004, COUNTER005, COUNTER006, COUNTER007, COUNTER008, COUNTER009, COUNTER010, rank() over(partition by BTS, SECT, CARR order by COUNTER007 desc, HOUR) AS RN from AGG_PM_CARR_HOUR WHERE TIMESTART = '@DATE') A WHERE A.RN = 1
BUSYSECT|counter001|SELECT * FROM (SELECT STARTTIME, HOUR,MANUFACTORYID, CITYID, BSC, BTS, SECT, COUNTER001, COUNTER002, COUNTER003, COUNTER004, COUNTER005, COUNTER006, COUNTER007, COUNTER008, COUNTER009, COUNTER010, rank() over(partition by BTS, SECT order by COUNTER007 desc, HOUR) AS RN from AGG_PM_SECT_HOUR WHERE TIMESTART = '@DATE') A WHERE A.RN = 1
TIPS|Rssi|SELECT CITYID,BSC,BTS,SECT, CASE WHEN MANUFACTORYID = 1 THEN -85.0 WHEN MANUFACTORYID = 2 THEN -87.0 WHEN MANUFACTORYID = 3 THEN 18.0 ELSE 0.0 END T0RSSI,SUM(SUMERL)ORDERVALUE1 ,0.0 ORDERVALUE2 FROM ( SELECT TIMESTART,MANUFACTORYID,CITYID,BSC,BTS,SECT,SUM(SUMERL) SUMERL,MAX(RSSILOGIN) RSSILOGIN FROM ( SELECT TIMESTART,HOUR,MANUFACTORYID,CITYID,BSC,BTS,SECT,SUM(COUNTER007) SUMERL, CASE WHEN AVG(COUNTER008) > 0.3 AND SUM( CASE WHEN (CASE WHEN COUNTER005=0 THEN -100 ELSE COUNTER005 END)> CASE WHEN MANUFACTORYID = 1 THEN -85 WHEN MANUFACTORYID = 2 THEN -87 WHEN MANUFACTORYID = 3 THEN 18 ELSE 0 END OR (CASE WHEN COUNTER006=0 THEN -100 ELSE COUNTER006 END) > CASE WHEN MANUFACTORYID = 1 THEN -85 WHEN MANUFACTORYID = 2 THEN -87 WHEN MANUFACTORYID = 3 THEN 18 ELSE 0 END THEN 1 ELSE 0 END )> 0 THEN 1 ELSE 0 END RSSILOGIN FROM AGG_PM_CARR_HOUR WHERE ( TIMESTART = '@DATE00' OR TIMESTART = '@DATE01' OR TIMESTART = '@DATE02' OR TIMESTART = '@DATE03' OR TIMESTART = '@DATE04' OR TIMESTART = '@DATE05' OR TIMESTART = '@DATE06' ) GROUP BY TIMESTART,HOUR,MANUFACTORYID,CITYID,BSC,BTS,SECT ) K1 GROUP BY TIMESTART,MANUFACTORYID,CITYID,BSC,BTS,SECT ) K2 GROUP BY MANUFACTORYID,CITYID,BSC,BTS,SECT HAVING SUM(RSSILOGIN) >= 3
TIPS|Conn|SELECT M.CITYID, M.BSC, M.BTS, M.SECT, MAX(CASE WHEN M.TIMESTART = '@DATE00' THEN M.T0_CONNECTRATE ELSE 0.0 END) T0_CONNECTRATE, MAX(CASE WHEN M.TIMESTART = '@DATE00' THEN M.ORDERVALUE1 ELSE 0.0 END) ORDERVALUE1, MAX(CASE WHEN M.TIMESTART = '@DATE00' THEN M.ORDERVALUE2 ELSE 0.0 END) ORDERVALUE2 FROM (SELECT A.TIMESTART, A.CITYID, A.BSC, A.BTS, A.SECT, A.ERL ORDERVALUE1, 0 ORDERVALUE2, CASE WHEN (A.CONNREAT <= B.T0_CONNECTRATE - 0.03 AND ERL >= 1) THEN 2 ELSE 0 END BREAKSTATUS, B.T0_CONNECTRATE T0_CONNECTRATE FROM (SELECT TIMESTART, CITYID, BSC, BTS, SECT, CASE WHEN (COUNTER002 = 0 OR COUNTER001 > COUNTER002) THEN 1 ELSE (1.0 * COUNTER001 / COUNTER002) END CONNREAT, COUNTER007 ERL FROM AGG_PM_SECT_BUSY WHERE (TIMESTART = '@DATE00' OR TIMESTART = '@DATE01' OR TIMESTART = '@DATE02' OR TIMESTART = '@DATE03' OR TIMESTART = '@DATE04' OR TIMESTART = '@DATE05' OR TIMESTART = '@DATE06') AND BTS = 3117) A LEFT JOIN (SELECT CITYID, BSC, BTS, SECT, CASE WHEN SUM(COUNTER002) = 0 THEN 1 ELSE (1.0 * SUM(CASE WHEN (COUNTER001 > COUNTER002) THEN COUNTER002 ELSE COUNTER001 END) / SUM(COUNTER002)) END T0_CONNECTRATE FROM AGG_PM_SECT_BUSY WHERE (TIMESTART = '@DATE07' OR TIMESTART = '@DATE08' OR TIMESTART = '@DATE09' OR TIMESTART = '@DATE10' OR TIMESTART = '@DATE11' OR TIMESTART = '@DATE12' OR TIMESTART = '@DATE13') AND BTS = 3117 GROUP BY CITYID, BSC, BTS, SECT) B ON A.CITYID = B.CITYID AND A.BSC = B.BSC AND A.BTS = B.BTS AND A.SECT = B.SECT ORDER BY BTS,SECT ,TIMESTART ) M GROUP BY M.CITYID, M.BSC, M.BTS, M.SECT HAVING SUM(CASE WHEN BREAKSTATUS = 2 THEN 1 ELSE 0 END ) >= 3 
TIPS|Drop|SELECT M.CITYID, M.BSC, M.BTS, M.SECT, MAX(CASE WHEN M.TIMESTART = '@DATE00' THEN M.T0_DROPRATE ELSE 0.0 END) T0_DROPRATE, MAX(CASE WHEN M.TIMESTART = '@DATE00' THEN M.ORDERVALUE1 ELSE 0.0 END) ORDERVALUE1, MAX(CASE WHEN M.TIMESTART = '@DATE00' THEN M.ORDERVALUE2 ELSE 0.0 END) ORDERVALUE2 FROM (SELECT A.TIMESTART, A.CITYID, A.BSC, A.BTS, A.SECT, A.ERL ORDERVALUE1, A.DROPREATFZ ORDERVALUE2, CASE WHEN (A.DROPREAT >= B.T0_DROPRATE + 0.03 AND ERL >= 5 AND A.DROPREATFZ >= 5) THEN 2 ELSE 0 END BREAKSTATUS, B.T0_DROPRATE T0_DROPRATE FROM (SELECT TIMESTART, CITYID, BSC, BTS, SECT, CASE WHEN (COUNTER004 = 0 OR COUNTER003 > COUNTER004) THEN 0 ELSE (1.0 * COUNTER003 / COUNTER004) END DROPREAT, COUNTER007 ERL, CASE WHEN (COUNTER004 = 0 OR COUNTER003 > COUNTER004) THEN 0 ELSE 1.0 * COUNTER003 END DROPREATFZ FROM AGG_PM_SECT_BUSY WHERE TIMESTART = '@DATE00' OR TIMESTART = '@DATE01' OR TIMESTART = '@DATE02' OR TIMESTART = '@DATE03' OR TIMESTART = '@DATE04' OR TIMESTART = '@DATE05' OR TIMESTART = '@DATE06') A LEFT JOIN (SELECT CITYID, BSC, BTS, SECT, CASE WHEN SUM(COUNTER004) = 0 THEN 1 ELSE 1.0 * SUM(CASE WHEN (COUNTER003 > COUNTER004) THEN 0 ELSE COUNTER003 END) / SUM(COUNTER004) END T0_DROPRATE FROM AGG_PM_SECT_BUSY WHERE TIMESTART = '@DATE07' OR TIMESTART = '@DATE08' OR TIMESTART = '@DATE09' OR TIMESTART = '@DATE10' OR TIMESTART = '@DATE11' OR TIMESTART = '@DATE12' OR TIMESTART = '@DATE13' GROUP BY CITYID, BSC, BTS, SECT) B ON A.CITYID = B.CITYID AND A.BSC = B.BSC AND A.BTS = B.BTS AND A.SECT = B.SECT) M GROUP BY M.CITYID, M.BSC, M.BTS, M.SECT HAVING SUM(CASE WHEN BREAKSTATUS = 2 THEN 1 ELSE 0 END ) >= 3 
RECOVER|Conn| SELECT 'Conn' TIPTYPE, CITYID,BSC,BTS,SECT FROM ( SELECT A.CITYID,A.BSC,A.BTS,A.SECT, CASE WHEN (A.COUNTER002 = 0) THEN 1.0 ELSE 1.0*COUNTER001/COUNTER002 END CONNRATE ,B.TOVALUE FROM AGG_PM_SECT_BUSY A LEFT JOIN ( SELECT CITYID,BSC,BTS,SECT,TOVALUE FROM AGG_PM_FAULT_CUR_OBJECT WHERE STIME != '@DATE00' AND STIME != '@DATE01' AND STIME != '@DATE02' AND STIME != '@DATE03' AND STIME != '@DATE04' AND TIPTYPE = 'Conn' AND TIMESTART = '@DATE01') B ON A.CITYID = B.CITYID AND A.BSC = B.BSC AND A.BTS = B.BTS AND A.SECT = B.SECT WHERE ( A.TIMESTART = '@DATE00' OR A.TIMESTART = '@DATE01' OR A.TIMESTART = '@DATE02' OR A.TIMESTART = '@DATE03' OR A.TIMESTART = '@DATE04' ) ) M GROUP BY CITYID,BSC,BTS,SECT HAVING SUM(CASE WHEN CONNRATE >= TOVALUE THEN 1 ELSE 0 END)=4
RECOVER|Drop| SELECT 'Drop' TIPTYPE, CITYID,BSC,BTS,SECT FROM ( SELECT A.CITYID,A.BSC,A.BTS,A.SECT, CASE WHEN (A.COUNTER004 = 0) THEN 0.0 ELSE 1.0*COUNTER003/COUNTER004 END DROPRATE ,B.TOVALUE FROM AGG_PM_SECT_BUSY A LEFT JOIN ( SELECT CITYID,BSC,BTS,SECT,TOVALUE FROM AGG_PM_FAULT_CUR_OBJECT WHERE STIME != '@DATE00' AND STIME != '@DATE01' AND STIME != '@DATE02' AND STIME != '@DATE03' AND STIME != '@DATE04' AND TIPTYPE = 'Drop' AND TIMESTART = '@DATE01' ) B ON A.CITYID = B.CITYID AND A.BSC = B.BSC AND A.BTS = B.BTS AND A.SECT = B.SECT WHERE ( A.TIMESTART = '@DATE00' OR A.TIMESTART = '@DATE01' OR A.TIMESTART = '@DATE02' OR A.TIMESTART = '@DATE03' OR A.TIMESTART = '@DATE04' ) ) M GROUP BY CITYID,BSC,BTS,SECT HAVING SUM(CASE WHEN DROPRATE <= TOVALUE THEN 1 ELSE 0 END)=4
RECOVER|Rssi| SELECT 'Rssi' TIPTYPE, CITYID, BSC, BTS, SECT FROM (SELECT A.CITYID, A.BSC, A.BTS, A.SECT, CASE WHEN A.COUNTER005=0 THEN -100 ELSE A.COUNTER005 END AS RSSIDIV, CASE WHEN A.COUNTER006=0 THEN -100 ELSE A.COUNTER006 END AS RSSIMAIN, B.TOVALUE FROM AGG_PM_CARR_HOUR A LEFT JOIN (SELECT TIPTYPE,CITYID, BSC, BTS, SECT, TOVALUE FROM AGG_PM_FAULT_CUR_OBJECT WHERE STIME != '@DATE00' AND STIME = '@DATE01' AND STIME != '@DATE02' AND STIME != '@DATE03' AND STIME != '@DATE04' AND TIMESTART = '@DATE01' ) B ON A.CITYID = B.CITYID AND A.BSC = B.BSC AND A.BTS = B.BTS AND A.SECT = B.SECT WHERE (A.TIMESTART = '@DATE00' OR A.TIMESTART = '@DATE01' OR A.TIMESTART = '@DATE02' OR A.TIMESTART = '@DATE03' OR A.TIMESTART = '@DATE04') AND B.TIPTYPE = 'Rssi' ) M GROUP BY CITYID, BSC, BTS, SECT HAVING SUM(CASE WHEN RSSIDIV >= TOVALUE OR RSSIMAIN >= TOVALUE THEN 1 ELSE 0 END) = 0
LTEZTE|counter001|SELECT CELLERABSTAT.ENODEBID,CELLERABSTAT.CELLID,SUM(CELLERABSTAT.C373210461+CELLUSERSTAT.C373240828+CELLERABTIME.C373505473+CELLERABTIME.C373505481+CELLERABADDHO.C373546257)VALUE FROM ETL_ZTE_R_B_CELLERABSTAT CELLERABSTAT LEFT JOIN ETL_ZTE_R_B_CELLUSERSTAT CELLUSERSTAT ON CELLUSERSTAT.STARTTIME = CELLERABSTAT.STARTTIME AND CELLERABSTAT.ENODEBID = CELLUSERSTAT.ENODEBID AND CELLERABSTAT.CELLID = CELLUSERSTAT.CELLID LEFT JOIN ETL_ZTE_R_B_CELLERABTIME CELLERABTIME ON CELLERABSTAT.STARTTIME = CELLERABTIME.STARTTIME AND CELLERABSTAT.ENODEBID = CELLERABTIME.ENODEBID AND CELLERABSTAT.CELLID = CELLERABTIME.CELLID LEFT JOIN ETL_ZTE_R_B_CELLERABADDHO CELLERABADDHO ON CELLERABSTAT.STARTTIME = CELLERABADDHO.STARTTIME AND CELLERABSTAT.ENODEBID = CELLERABADDHO.ENODEBID AND CELLERABSTAT.CELLID = CELLERABADDHO.CELLID WHERE CELLERABSTAT.TIMESTART = '@DATE' GROUP BY CELLERABSTAT.ENODEBID,CELLERABSTAT.CELLID
LTEZTE|counter002|SELECT CELLERABSTAT.ENODEBID,CELLERABSTAT.CELLID,SUM(CELLERABSTAT.C373210381+CELLERABSTAT.C373210391+CELLERABSTAT.C373210421+CELLERABSTAT.C373210441+CELLERABSTAT.C373210451+CELLERABSTAT.C373210511+CELLERABSTAT.C373210521+CELLERABTIME.C373505354)VALUE FROM ETL_ZTE_R_B_CELLERABSTAT CELLERABSTAT LEFT JOIN ETL_ZTE_R_B_CELLERABTIME CELLERABTIME ON CELLERABSTAT.STARTTIME = CELLERABTIME.STARTTIME AND CELLERABSTAT.ENODEBID = CELLERABTIME.ENODEBID AND CELLERABSTAT.CELLID = CELLERABTIME.CELLID WHERE CELLERABSTAT.TIMESTART = '@DATE' GROUP BY CELLERABSTAT.ENODEBID,CELLERABSTAT.CELLID
LTEZTE|counter003|SELECT ENODEBID,CELLID,SUM(CELLERABTIME.C373505472+CELLERABTIME.C373505480)VALUE FROM  ETL_ZTE_R_B_CELLERABTIME CELLERABTIME WHERE TIMESTART = '@DATE' GROUP BY ENODEBID,CELLID
LTEZTE|counter004|SELECT ENODEBID,CELLID,SUM(CELLERABTIME.C373505473+CELLERABTIME.C373505481)VALUE FROM  ETL_ZTE_R_B_CELLERABTIME CELLERABTIME WHERE TIMESTART = '@DATE' GROUP BY ENODEBID,CELLID
LTEZTE|counter005|SELECT ENODEBID,CELLID,SUM(CELLRRCCONN.C373200084+CELLRRCCONN.C373200085+CELLRRCCONN.C373200086+CELLRRCCONN.C373200087+CELLRRCCONN.C373200088+CELLRRCCONN.C373200124) VALUE FROM  ETL_ZTE_R_B_CELLRRCCONN CELLRRCCONN WHERE TIMESTART = '@DATE' GROUP BY ENODEBID,CELLID
LTEZTE|counter006|SELECT ENODEBID,CELLID,SUM(CELLRRCCONN.C373200000+CELLRRCCONN.C373200004+CELLRRCCONN.C373200008+CELLRRCCONN.C373200012+CELLRRCCONN.C373200016+CELLRRCCONN.C373200120) VALUE FROM  ETL_ZTE_R_B_CELLRRCCONN CELLRRCCONN WHERE TIMESTART = '@DATE' GROUP BY ENODEBID,CELLID
LTEZTE|counter007|SELECT ENODEBID,CELLID,SUM((CELLTHRPUT.C373343804*1000+CELLTHRPUT.C373343805)/(8*1000))VALUE FROM ETL_ZTE_R_B_CELLTHRPUT CELLTHRPUT WHERE TIMESTART = '@DATE' GROUP BY ENODEBID,CELLID
LTEZTE|counter008|SELECT ENODEBID,CELLID,SUM((CELLTHRPUT.C373343806*1000+CELLTHRPUT.C373343807)/(8*1000))VALUE FROM ETL_ZTE_R_B_CELLTHRPUT CELLTHRPUT WHERE TIMESTART = '@DATE' GROUP BY ENODEBID,CELLID
LTEZTE|counter009|SELECT ENODEBID,CELLID,MAX(CELLACTUE.C373384348)VALUE FROM ETL_ZTE_R_B_CELLACTUE  CELLACTUE WHERE TIMESTART = '@DATE' GROUP BY ENODEBID,CELLID
LTEHW|counter001|SELECT ENODEBID,CellID,SUM(ETL_HW_RESULT_1526726660_3.Counter_1526727547+ETL_HW_RESULT_1526726660_3.Counter_1526727546) FROM ETL_HW_RESULT_1526726660_3 WHERE TIMESTART = '@DATE' GROUP BY ENODEBID,CellID
LTEHW|counter002|SELECT ENODEBID,CellID,SUM(ETL_HW_RESULT_1526726660_3.Counter_1526727546) FROM ETL_HW_RESULT_1526726660_3 WHERE TIMESTART = '@DATE' GROUP BY ENODEBID,CellID
LTEHW|counter003|SELECT ENODEBID,CellID,SUM(ETL_HW_RESULT_1526726659_3.Counter_1526727545) FROM ETL_HW_RESULT_1526726659_3 WHERE TIMESTART = '@DATE' GROUP BY ENODEBID,CellID
LTEHW|counter004|SELECT ENODEBID,CellID,SUM(ETL_HW_RESULT_1526726659_3.Counter_1526727544) FROM ETL_HW_RESULT_1526726659_3 WHERE TIMESTART = '@DATE' GROUP BY ENODEBID,CellID
LTEHW|counter005|SELECT ENODEBID,CellID,SUM(ETL_HW_RESULT_1526726657_3.Counter_1526728217+ETL_HW_RESULT_1526726657_3.Counter_1526728218+ETL_HW_RESULT_1526726657_3.Counter_1526728220+ETL_HW_RESULT_1526726657_3.Counter_1526728221+ETL_HW_RESULT_1526726657_3.Counter_1526728357+ETL_HW_RESULT_1526726657_3.Counter_1526728219) FROM ETL_HW_RESULT_1526726657_3 WHERE TIMESTART = '@DATE' GROUP BY ENODEBID,CellID
LTEHW|counter006|SELECT ENODEBID,CellID,SUM(ETL_HW_RESULT_1526726657_3.Counter_1526728222+ETL_HW_RESULT_1526726657_3.Counter_1526728223+ETL_HW_RESULT_1526726657_3.Counter_1526728225+ETL_HW_RESULT_1526726657_3.Counter_1526728226+ETL_HW_RESULT_1526726657_3.Counter_1526728358+ETL_HW_RESULT_1526726657_3.Counter_1526728224) FROM ETL_HW_RESULT_1526726657_3 WHERE TIMESTART = '@DATE' GROUP BY ENODEBID,CellID
LTEHW|counter007|SELECT ENODEBID,CellID,SUM(ETL_HW_RESULT_1526726664_3.Counter_1526728259/1000/1000/8) FROM ETL_HW_RESULT_1526726664_3 WHERE TIMESTART = '@DATE' GROUP BY ENODEBID,CellID
LTEHW|counter008|SELECT ENODEBID,CellID,SUM(ETL_HW_RESULT_1526726664_3.Counter_1526728261/1000/1000/8) FROM ETL_HW_RESULT_1526726664_3 WHERE TIMESTART = '@DATE' GROUP BY ENODEBID,CellID
LTEHW|counter009|SELECT ENODEBID,CellID,MAX(ETL_HW_RESULT_1526726705_3.Counter_1526728976) FROM ETL_HW_RESULT_1526726705_3 WHERE TIMESTART = '@DATE' GROUP BY ENODEBID,CellID
LTEBUSYSECT|counter001|SELECT * FROM (SELECT STARTTIME, HOUR, manufactoryid, ENODEBID, SECT, COUNTER001, COUNTER002, COUNTER003, COUNTER004, COUNTER005, COUNTER006, COUNTER007, COUNTER008, COUNTER009, COUNTER010, rank() over(partition by ENODEBID, SECT order by COUNTER007+COUNTER008 desc, HOUR) AS RN from AGG_PM_LTE_SECT_HOUR WHERE TIMESTART = '@DATE') A WHERE A.RN = 1
LTEGROUPSECT|counter001|SELECT STARTTIME, MANUFACTORYID, ENODEBID, SECT, SUM(COUNTER001), SUM(COUNTER002), SUM(COUNTER003), SUM(COUNTER004), SUM(COUNTER005), SUM(COUNTER006), SUM(COUNTER007), SUM(COUNTER008), MAX(COUNTER009) FROM AGG_PM_LTE_SECT_HOUR WHERE TIMESTART = '@DATE' GROUP BY STARTTIME, MANUFACTORYID, ENODEBID, SECT
LTETIPS|RRCCONN|SELECT ETL_CITY.CITYID,M.ENODEBID,M.SECT,M.R2 T0VALUE,MAX(M.ORDEVALUE1) ORDEVALUE1,0.0 FROM ( SELECT  THISWEEK.STARTTIME,THISWEEK.ENODEBID,THISWEEK.SECT, THISWEEK.RRCCONNRATE R1,LASTWEEK.RRCCONNRATE R2, THISWEEK.ORDEVALUE1, THISWEEK.RRCCONNRATEFM, THISWEEK.USERSNUM FROM  ( SELECT STARTTIME,ENODEBID,SECT,  CASE WHEN COUNTER005 = 0.0 OR COUNTER006 > COUNTER005 THEN 1.0 ELSE COUNTER006/ COUNTER005 END  RRCCONNRATE, COUNTER006 RRCCONNRATEFM, COUNTER009 USERSNUM, CASE WHEN TIMESTART = '@DATE00' THEN COUNTER007+COUNTER008 ELSE 0 END ORDEVALUE1 FROM AGG_PM_LTE_SECT_BUSY A WHERE TIMESTART > '@DATE07' AND TIMESTART<= '@DATE00' ) THISWEEK LEFT JOIN ( SELECT ENODEBID,SECT, CASE WHEN SUM(COUNTER005) = 0.0 OR SUM(COUNTER006) > SUM(COUNTER005) THEN 1 ELSE SUM(COUNTER006)/ SUM(COUNTER005) END  RRCCONNRATE FROM AGG_PM_LTE_SECT_BUSY B WHERE TIMESTART > '@DATE14' AND TIMESTART<= '@DATE07'  GROUP BY ENODEBID,SECT ) LASTWEEK ON THISWEEK.ENODEBID = LASTWEEK.ENODEBID AND THISWEEK.SECT = LASTWEEK.SECT ) M LEFT JOIN ETL_LTE_ENODEB_CITY ETL_CITY ON M.ENODEBID = ETL_CITY.ENODEBID GROUP BY  ETL_CITY.CITYID,M.ENODEBID,M.SECT,M.R2 HAVING SUM(CASE WHEN M.R2 -M.R1 >= 0.05 AND RRCCONNRATEFM > 100 AND USERSNUM > 3 THEN 1 ELSE 0 END) >=3
LTERECOVER|RRCCONN|SELECT 'RRCCONN' TIPTYPE, CITYID,ENODEBID,SECT FROM ( SELECT B.CITYID,A.ENODEBID,A.SECT, CASE WHEN (A.COUNTER005 = 0 OR COUNTER006 > COUNTER005) THEN 1.0 ELSE 1.0*COUNTER006/COUNTER005 END RRCCONNRATE ,B.TOVALUE FROM AGG_PM_LTE_SECT_BUSY A LEFT JOIN ( SELECT CITYID,ENODEBID,SECT,TOVALUE FROM AGG_PM_LTE_FAULT_CUR_OBJECT WHERE STIME != '@DATE00' AND STIME != '@DATE01' AND STIME != '@DATE02' AND STIME != '@DATE03' AND STIME != '@DATE04' AND TIPTYPE = 'RRCCONN' AND TIMESTART = '@DATE01' ) B ON A.ENODEBID = B.ENODEBID AND A.SECT = B.SECT WHERE ( A.TIMESTART = '@DATE00' OR A.TIMESTART = '@DATE01' OR A.TIMESTART = '@DATE02' OR A.TIMESTART = '@DATE03' OR A.TIMESTART = '@DATE04' ) ) M GROUP BY CITYID,ENODEBID,SECT HAVING SUM(CASE WHEN RRCCONNRATE >= TOVALUE -0.03 THEN 1 ELSE 0 END)=4
LTETIPS|ERABDROP|SELECT ETL_CITY.CITYID, M.ENODEBID, M.SECT, M.R2 T0VALUE, MAX(M.ORDEVALUE1) ORDEVALUE1, 0.0 FROM (SELECT THISWEEK.STARTTIME, THISWEEK.ENODEBID, THISWEEK.SECT, THISWEEK.RABCONNRATE R1, LASTWEEK.RABCONNRATE R2, THISWEEK.ORDEVALUE1, THISWEEK.RABCONNRATEFM, THISWEEK.TOTALFLOW, THISWEEK.USERSNUM FROM (SELECT LTE_BUSY.STARTTIME, LTE_BUSY.ENODEBID, LTE_BUSY.SECT, CASE WHEN LTE_BUSY.COUNTER001 = 0.0 OR LTE_BUSY.COUNTER002 > LTE_BUSY.COUNTER001 THEN 0.0 ELSE LTE_BUSY.COUNTER002 / LTE_BUSY.COUNTER001 END RABCONNRATE, LTE_BUSY.COUNTER001 RABCONNRATEFM, LTE_DAY.COUNTER007 + LTE_DAY.COUNTER008 TOTALFLOW, LTE_DAY.COUNTER009 USERSNUM, CASE WHEN LTE_DAY.TIMESTART = '@DATE00' THEN LTE_DAY.COUNTER007 + LTE_DAY.COUNTER008 ELSE 0.0 END ORDEVALUE1 FROM AGG_PM_LTE_SECT_BUSY LTE_BUSY LEFT JOIN AGG_PM_LTE_SECT_DAY LTE_DAY ON LTE_BUSY.ENODEBID = LTE_DAY.ENODEBID AND LTE_BUSY.SECT = LTE_DAY.SECT AND LTE_BUSY.TIMESTART = LTE_DAY.TIMESTART WHERE LTE_BUSY.TIMESTART > '@DATE07' AND LTE_BUSY.TIMESTART <= '@DATE00' AND LTE_DAY.TIMESTART > '@DATE07' AND LTE_DAY.TIMESTART <= '@DATE00') THISWEEK LEFT JOIN (SELECT ENODEBID, SECT, CASE WHEN SUM(COUNTER002) = 0.0 OR SUM(COUNTER002) > SUM(COUNTER001) THEN 0.0 ELSE SUM(COUNTER002) / SUM(COUNTER001) END RABCONNRATE FROM AGG_PM_LTE_SECT_BUSY B WHERE TIMESTART > '@DATE14' AND TIMESTART <= '@DATE07' GROUP BY ENODEBID, SECT) LASTWEEK ON THISWEEK.ENODEBID = LASTWEEK.ENODEBID AND THISWEEK.SECT = LASTWEEK.SECT) M LEFT JOIN ETL_LTE_ENODEB_CITY ETL_CITY ON M.ENODEBID = ETL_CITY.ENODEBID GROUP BY ETL_CITY.CITYID, M.ENODEBID, M.SECT, M.R2 HAVING SUM(CASE WHEN M.R1 - M.R2 >= 0.05 AND RABCONNRATEFM > 100 AND TOTALFLOW > 50 AND USERSNUM > 5 THEN 1 ELSE 0 END) >= 3
LTERECOVER|ERABDROP|SELECT 'ERABDROP' TIPTYPE, CITYID,ENODEBID,SECT FROM ( SELECT B.CITYID,A.ENODEBID,A.SECT, CASE WHEN (A.COUNTER001 = 0 OR COUNTER002 > COUNTER001) THEN 0.0 ELSE 1.0*COUNTER002/COUNTER001 END ERABDROPRATE ,B.TOVALUE FROM AGG_PM_LTE_SECT_BUSY A LEFT JOIN ( SELECT CITYID,ENODEBID,SECT,TOVALUE FROM AGG_PM_LTE_FAULT_CUR_OBJECT WHERE STIME != '@DATE00' AND STIME != '@DATE01' AND STIME != '@DATE02' AND STIME != '@DATE03' AND STIME != '@DATE04' AND TIPTYPE = 'ERABDROP' AND TIMESTART = '@DATE01' ) B ON A.ENODEBID = B.ENODEBID AND A.SECT = B.SECT WHERE ( A.TIMESTART = '@DATE00' OR A.TIMESTART = '@DATE01' OR A.TIMESTART = '@DATE02' OR A.TIMESTART = '@DATE03' OR A.TIMESTART = '@DATE04' ) ) M GROUP BY CITYID,ENODEBID,SECT HAVING SUM(CASE WHEN ERABDROPRATE <= TOVALUE THEN 1 ELSE 0 END)=4
LTETIPS|ERABCONN|SELECT ETL_CITY.CITYID, M.ENODEBID, M.SECT, M.R2 T0VALUE, MAX(M.ORDEVALUE1) ORDEVALUE1, 0.0 FROM (SELECT THISWEEK.STARTTIME, THISWEEK.ENODEBID, THISWEEK.SECT, THISWEEK.ERABBUILDRATE R1, LASTWEEK.ERABBUILDRATE R2, THISWEEK.ORDEVALUE1, THISWEEK.ERABBUILDRATEFM, THISWEEK.FLOW, THISWEEK.USERSNUM FROM ( SELECT ETL_BUSY.STARTTIME, ETL_BUSY.ENODEBID, ETL_BUSY.SECT, CASE WHEN ETL_BUSY.COUNTER003 = 0.0 OR ETL_BUSY.COUNTER004 > ETL_BUSY.COUNTER003 THEN 1 ELSE ETL_BUSY.COUNTER004 / ETL_BUSY.COUNTER003 END ERABBUILDRATE, ETL_BUSY.COUNTER003 ERABBUILDRATEFM, ETL_DAY.COUNTER007 + ETL_DAY.COUNTER008 FLOW, ETL_DAY.COUNTER009 USERSNUM, CASE WHEN ETL_DAY.TIMESTART = '@DATE00' THEN ETL_DAY.COUNTER007 + ETL_DAY.COUNTER008 ELSE 0.0 END ORDEVALUE1 FROM AGG_PM_LTE_SECT_BUSY ETL_BUSY LEFT JOIN AGG_PM_LTE_SECT_DAY ETL_DAY ON ETL_BUSY.ENODEBID = ETL_DAY.ENODEBID AND ETL_BUSY.SECT = ETL_DAY.SECT AND ETL_BUSY.STARTTIME = ETL_DAY.STARTTIME WHERE ETL_BUSY.TIMESTART > '@DATE07' AND ETL_BUSY.TIMESTART <= '@DATE00' AND ETL_DAY.TIMESTART > '@DATE07' AND ETL_DAY.TIMESTART <= '@DATE00' )THISWEEK LEFT JOIN ( SELECT ENODEBID, SECT, CASE WHEN SUM(COUNTER003) = 0.0 OR SUM(COUNTER004) > SUM(COUNTER003) THEN 1.0 ELSE SUM(COUNTER004) / SUM(COUNTER003) END ERABBUILDRATE FROM AGG_PM_LTE_SECT_BUSY B WHERE TIMESTART > '@DATE14' AND TIMESTART <= '@DATE07' GROUP BY ENODEBID, SECT ) LASTWEEK ON THISWEEK.ENODEBID = LASTWEEK.ENODEBID AND THISWEEK.SECT = LASTWEEK.SECT )M LEFT JOIN ETL_LTE_ENODEB_CITY ETL_CITY ON M.ENODEBID = ETL_CITY.ENODEBID GROUP BY ETL_CITY.CITYID, M.ENODEBID, M.SECT, M.R2 HAVING SUM(CASE WHEN M.R2 - M.R1 >= 0.08 AND ERABBUILDRATEFM > 100 AND FLOW > 50 AND USERSNUM > 3 THEN 1 ELSE 0 END) >= 3
LTERECOVER|ERABCONN|SELECT 'ERABCONN' TIPTYPE, CITYID,ENODEBID,SECT FROM ( SELECT B.CITYID,A.ENODEBID,A.SECT, CASE WHEN (A.COUNTER003 = 0 OR COUNTER004 > COUNTER003) THEN 1.0 ELSE 1.0*COUNTER004/COUNTER003 END ERABCONNRATE ,B.TOVALUE FROM AGG_PM_LTE_SECT_BUSY A LEFT JOIN ( SELECT CITYID,ENODEBID,SECT,TOVALUE FROM AGG_PM_LTE_FAULT_CUR_OBJECT WHERE STIME != '@DATE00' AND STIME != '@DATE01' AND STIME != '@DATE02' AND STIME != '@DATE03' AND STIME != '@DATE04' AND TIPTYPE = 'ERABCONN' AND TIMESTART = '@DATE01' ) B ON A.ENODEBID = B.ENODEBID AND A.SECT = B.SECT WHERE ( A.TIMESTART = '@DATE00' OR A.TIMESTART = '@DATE01' OR A.TIMESTART = '@DATE02' OR A.TIMESTART = '@DATE03' OR A.TIMESTART = '@DATE04' ) ) M GROUP BY CITYID,ENODEBID,SECT HAVING SUM(CASE WHEN ERABCONNRATE >= TOVALUE THEN 1 ELSE 0 END)=4